# Long-term Optimization Proposal - tw-top10 選股系統

根據對國際級量化交易框架（Qlib, vectorbt, MLflow 等）的研究，我為本專案規劃了以下四大維度的長期優化方向。這些優化將使系統從「自動選股工具」演進為「專業級量化研究平台」。

---

## 🏗️ 1. 資料架構升級 (Data Layer)

### 現狀
目前主要依賴 TWSE/TPEX 官方 RWD API，資料維度以技術面為主（開高低收量）。

### 優化方向：整合 FinMind / OpenAPI
- **籌碼面整合**：引入「三大法人買賣超」、「融資融券」、「大股東持股分佈」。
- **基本面整合**：引入「每季財報」、「每月營收成長率」。
- **資料顆粒度**：評估引入 Minute-level 資料以優化進出場時機（目前僅使用 Daily）。

> [!TIP]
> **FinMind** 提供的資料種類豐富且格式統一，非常適合作為我們的第二資料源。

---

## 🧠 2. 實驗管理與建模 (Model Layer)

### 現狀
模型訓練雖然自動化，但缺乏詳細的實驗紀錄、參數對比與模型版本控管 (Model Registry)。

### 優化方向：引入 MLflow
- **實驗追蹤 (Experiment Tracking)**：自動記錄每次 Optuna 調優的 Metrics、Params 與收斂曲線。
- **模型倉庫 (Model Registry)**：標記 "Production" 或 "Staging" 模型版本，實現無縫切換。
- **Auto-logging**：利用 `mlflow.lightgbm.autolog()` 自動擷取特徵重要性與學習曲線。

---

## ⚖️ 3. 高效率回測系統 (Backtest Layer)

### 現狀
目前回測使用單執行緒循環遍歷，在進行「參數掃描（Param Sweep）」時速度較慢。

### 優化方向：引入 vectorbt
- **向量化加速**：使用 NumPy/Numba 的向量化運算，比傳統迴圈快數百倍。
- **大規模參數掃描**：可瞬間測試上千組「停損、停利、勝率門檻」組合，尋找獲利期望值最高的參數。

---

## 🎨 4. UI/UX 與視覺化 (Visualization Layer)

### 現狀
目前的 Web UI 為基礎版，以表格展示為主。

### 優化方向：專業級量化儀表板
- **互動式權益曲線 (Equity Curve)**：參考 `vectorbt` 的展示方式，加入 Max Drawdown 標註與滑動縮放。
- **歸因分析 (Attribution Analysis)**：視覺化展示哪些特徵（例如：成交量、乖離率）對單一選股決策的影響力最強。
- **行動端優化**：優化手機瀏覽體驗，並加入通知推播功能的配置介面。

---

## 📈 實施路徑建議

| 階段 | 重點項目 | 預期效益 |
| :--- | :--- | :--- |
| **階段一** | 整合 FinMind 籌碼面資料 | 提升特徵質量，增加勝率 |
| **階段二** | 導入 MLflow 實驗管理 | 系統化管理模型迭代，減少混亂 |
| **階段三** | 升級 vectorbt 回測系統 | 找出最佳交易策略參數 |
| **階段四** | UI/UX 深度改造 | 提升決策效率與使用感 |

---

> [!IMPORTANT]
> **相容性評估**
> 以上優化均採「模組化掛載」設計，不會與目前的自動化架構衝突，可逐步分批更換。
